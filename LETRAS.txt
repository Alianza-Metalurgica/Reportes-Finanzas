SELECT ID, APPLICATION_DATE, AVAL_ID, QTY_PERIOD, QTY_LETTER, APPROBE_DATE, CURRENCY_ID, CUSTOMER_ID, ENTITY_ID, TOTAL_AMOUNT, STATUS
  FROM ARG_APPLICATION 
 WHERE ID = 'CNJ-0000759'

SELECT PL.LETTER_ID, PL.LETTER_AMOUNT, PL.LETTER_DATE 
  FROM ARG_APPLICATION_LINE PL
 WHERE PL.APPLICATION_ID = 'CNJ-0000759'
ORDER BY LETTER_DATE

SELECT AN.LETTER_ID, AN.INVOICE_ID, AN.AMOUNT, R.DUE_DATE, R.INST_NO, R.TOTAL_AMOUNT - R.PAID_AMOUNT
  FROM ARG_APPLICATION_NUMERALES AN, RECEIVABLE_INST R 
 WHERE AN.APPLICATION_ID = 'CNJ-0000759'
   AND AN.INVOICE_ID = R.INVOICE_ID
   AND AN.INST_NO = R.INST_NO
 ORDER BY LETTER_ID, R.DUE_DATE
 
SELECT AN.INVOICE_ID, R.INST_NO, SUM ( AN.AMOUNT ) 
  FROM ARG_APPLICATION_NUMERALES AN, RECEIVABLE_INST R
 WHERE AN.APPLICATION_ID = 'CNJ-0000759'
   AND AN.INVOICE_ID = R.INVOICE_ID
   AND AN.INST_NO = R.INST_NO
 GROUP BY AN.INVOICE_ID, R.INST_NO
 
SELECT CURRENCY_ID, SELL_RATE, BUY_RATE, AMOUNT, TRACKING_CURRENCY, S_CURRENCY, S_THOUSAND, I_CURRENCY, I_NEG_CURR,
       I_CURR_DIGITS, RND_ACCT_ID, REAL_GN_ACCT_ID, REAL_LS_ACCT_ID,UNREAL_GN_ACCT_ID, UNREAL_LS_ACCT_ID, ID
  FROM ARG_APPLICATION_CURR, CURRENCY
 WHERE APPLICATION_ID = 'CNJ-0000759'
   AND CURRENCY_ID = ID ORDER BY ID ASC
   
SELECT ISNULL ( DEF_TRANS_CURRENCY, CURRENCY_ID ), VAT_DISCOUNTED, VAT_ALWAYS_DISC, VAT_EXEMPT, ID, ALLOW_OVER_PAYMNT, ALLOW_ADJ_INVOICE, SALESREP_ID, 
       IGV_EXEMPT
  FROM CUSTOMER C, ARG_CUSTOMER AC
 WHERE C.ID = 'N131' AND C.ID = AC.CUSTOMER_ID
 
SELECT 9999, I.INVOICE_ID, RI.INST_NO, I.CURRENCY_ID, RI.TOTAL_AMOUNT,RI.PAID_AMOUNT, RI.TOTAL_AMOUNT - RI.PAID_AMOUNT -
       ISNULL ( ( SELECT SUM (IA.APPLY_AMOUNT )
                    FROM ARG_APPLICATION_INVOICE IA, ARG_APPLICATION AP
                   WHERE IA.APPLICATION_ID = AP.ID
                     AND AP.STATUS = 'H'
                     AND IA.INVOICE_ID = I.INVOICE_ID ), 0 ), 
       IS_LETTER, I.INVOICE_DATE, RI.LAST_PAID_DATE, ISNULL (I.NEW_SELL_RATE, I.SELL_RATE ), I.TERMS_NET_TYPE, I.TERMS_NET_DAYS,
       I.TERMS_NET_DATE, I.TERMS_DISC_TYPE, I.TERMS_DISC_DAYS, I.TERMS_DISC_DATE, I.TERMS_DISC_PERCENT, I.TERMS_DESCRIPTION, DUE_DATE, I.ENTITY_ID, 
       TC.CUST_ORDER_ID, TYPE, POSTING_DATE, RI.DUE_DATE
  FROM RECEIVABLE I, RECEIVABLE_INST RI, ARG_TIPO_CC TC
 WHERE I.CUSTOMER_ID = 'N131'
   AND I.INVOICE_ID = RI.INVOICE_ID
   --AND RI.TOTAL_AMOUNT <> RI.PAID_AMOUNT
   AND RI.TOTAL_AMOUNT <> 0
   AND I.INVOICE_ID = TC.INVOICE_ID
   --AND ISNULL ( STATUS_MEMO, 'A' ) = 'A' 
   --AND I.STATUS <> 'X'
   AND ENTITY_ID = '001'
  -- AND ( ABS ( RI.TOTAL_AMOUNT ) - ABS ( RI.PAID_AMOUNT ) - ISNULL ( ( SELECT SUM ( ABS ( IA.APPLY_AMOUNT ) ) FROM ARG_APPLICATION_INVOICE IA, ARG_APPLICATION AP WHERE IA.APPLICATION_ID = AP.ID AND AP.STATUS = 'H' AND IA.INVOICE_ID = I.INVOICE_ID ), 0 ) ) > 0
 ORDER BY 2 ASC, 3 ASC
 
 SELECT TOTAL_AMOUNT, PAID_AMOUNT FROM RECEIVABLE WHERE INVOICE_ID = '001-004856ND'
 
 SELECT CC.IGV_AMOUNT, ( CC.IGV_AMOUNT - ISNULL ( CC.PAID_IGV_AMOUNT, 0 ) ) FROM ARG_CUOTAS_CC CC WHERE CC.INVOICE_ID = 'LT-0010024' AND CC.NRO_CUOTA = 1.00000000

 SELECT VAT_AMOUNT, AMOUNT, VAT_PERCENT FROM RECEIVABLE_LINE WHERE INVOICE_ID='LT-0010024'
 
 SELECT * FROM ARG_APPLICATION_LINE WHERE LETTER_ID 
 
 SELECT * FROM ARG_APPLICATION_NUMERALES
 SELECT * FROM ARG_APPLICATION_INVOICE
 SELECT * FROM RECEIVABLE_INST WHERE INVOICE_ID =  'LT-0009845'
 --UPDATE RECEIVABLE_INST SET PAID_AMOUNT = 0 WHERE INVOICE_ID =  'LT-0009845'
 --APLT-0000526
 SELECT AA.ID,AA.STATUS [STATUS CANJE],AAN.LETTER_ID [NRO DOCUMENTO],AA.APPROBE_DATE [FECHA_COBRANZA],AAN.AMOUNT [COBRADO],AAN.INVOICE_ID [FACTURA],R.INVOICE_DATE  [FECHA FACTURA],
       R.TOTAL_AMOUNT AS [TOT FACTURA],R.PAID_AMOUNT [TOTAL PAGADO],C.ID,C.NAME [CLIENTE],R.STATUS [STATUS DOC],R.CURRENCY_ID [MONEDA],
       V.NAME AS [VENDEDOR],C.SIC_CODE [GRUPO],'','',RI.DUE_DATE,RI.LAST_PAID_DATE,
       CASE WHEN DATEDIFF ( DAY ,RI.DUE_DATE, RI.LAST_PAID_DATE ) > 0 THEN DATEDIFF ( DAY , RI.DUE_DATE, RI.LAST_PAID_DATE  ) ELSE 0 END [DIAS_EXCESO],
       (CASE WHEN R.CURRENCY_ID = 'SOL' THEN R.TOTAL_AMOUNT ELSE R.TOTAL_AMOUNT*R.SELL_RATE END  -
       CASE WHEN R.CURRENCY_ID = 'SOL' THEN R.PAID_AMOUNT ELSE R.PAID_AMOUNT*R.SELL_RATE END) [SALDO]
  FROM ARG_APPLICATION_NUMERALES AS AAN LEFT JOIN ARG_APPLICATION AS AA ON AAN.APPLICATION_ID = AA.ID
                                        LEFT JOIN RECEIVABLE AS R ON AAN.INVOICE_ID = R.INVOICE_ID
                                        LEFT JOIN CUSTOMER AS C ON AA.CUSTOMER_ID = C.ID
                                        LEFT JOIN SALES_REP V ON C.SALESREP_ID = V.ID
                                        LEFT JOIN RECEIVABLE_INST RI ON R.INVOICE_ID = RI.INVOICE_ID
